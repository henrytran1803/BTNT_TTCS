CREATE PROCEDURE KiemTraMaTPNT_MUON
    @MATPNT nchar(8)
AS
BEGIN
    SET NOCOUNT ON;

    IF EXISTS (SELECT 1 FROM TPNT WHERE MATPNT = @MATPNT)
    BEGIN
        IF EXISTS (SELECT 1 FROM SO_HUU WHERE MATPNT = @MATPNT)
        BEGIN
            RETURN 1;
        END
        ELSE
        BEGIN
            RETURN 0;
        END
    END
    ELSE
    BEGIN
        RETURN 1;
    END
END


CREATE PROCEDURE KiemTraXoaSua_MUON

    @MATPNT nchar(8)

AS

BEGIN

    SET NOCOUNT ON;

  

    IF EXISTS (SELECT 1 FROM MUON WHERE MATPNT = @MATPNT AND NGAYTRA < GETDATE())

        RETURN 1;

    ELSE

        RETURN 0;

END